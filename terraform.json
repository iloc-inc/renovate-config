{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "packageRules": [
    {
      "description": "Terraform providers: 手動。PRはまとめる。新着直後はPR作成を遅らせる＋lockfile更新",
      "matchManagers": ["terraform"],
      "matchDatasources": ["terraform-provider"],
      "groupName": "terraform providers",
      "labels": ["terraform", "provider"],
      "minimumReleaseAge": "3 days",
      "postUpdateOptions": ["terraformLockFile"],
      "rangeStrategy": "bump",
      "automerge": false
    },
    {
      "description": "hashicorp/aws の patch は自動マージ（PR経由）＋lockfile更新",
      "matchManagers": ["terraform"],
      "matchDatasources": ["terraform-provider"],
      "matchPackageNames": ["hashicorp/aws"],
      "matchUpdateTypes": ["patch"],
      "groupName": "aws provider (patch)",
      "labels": ["terraform", "provider", "aws"],
      "postUpdateOptions": ["terraformLockFile"],
      "rangeStrategy": "bump",
      "automerge": true,
      "automergeType": "pr"
    },
    {
      "description": "Terraform modules は手動（挙動差リスク大）",
      "matchManagers": ["terraform"],
      "matchDatasources": ["terraform-module"],
      "groupName": "terraform modules",
      "labels": ["terraform", "module"],
      "rangeStrategy": "bump",
      "separateMinorPatch": true,
      "automerge": false
    },
    {
      "description": "required_version（core本体）は常に手動",
      "matchManagers": ["terraform"],
      "matchDepTypes": ["required_version"],
      "groupName": "terraform core version",
      "labels": ["terraform", "core"],
      "automerge": false
    },
    {
      "description": ".terraform-version（tfenv）: patchは自動（PR経由）",
      "matchManagers": ["terraform-version"],
      "groupName": "terraform toolchain",
      "labels": ["terraform", "toolchain"],
      "matchUpdateTypes": ["patch"],
      "automerge": true,
      "automergeType": "pr"
    }
  ]
}
